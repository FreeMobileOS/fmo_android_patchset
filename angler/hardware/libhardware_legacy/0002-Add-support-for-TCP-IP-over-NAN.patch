From f1b1b38fee48e003d5f2fe5a87e0247927bb141f Mon Sep 17 00:00:00 2001
From: Peng Xu <pxu@codeaurora.org>
Date: Tue, 26 Jun 2018 11:24:32 -0700
Subject: [PATCH 2/2] Add support for TCP/IP over NAN

Add support for TCP/IP over NAN, add NDPE attribute support and
TCP/IP IPV6 address, port and protocol information in NAN publish,
subscribe, data path request and response messages.

Change-Id: I3e5644e5211995372439c584404bbbf026067771
CRs-fixed: 2267339
Signed-off-by: Satish Patel <tosatishpatel@gmail.com>
---
 include/hardware_legacy/wifi_nan.h | 44 ++++++++++++++++++++++++++++++
 1 file changed, 44 insertions(+)

diff --git a/include/hardware_legacy/wifi_nan.h b/include/hardware_legacy/wifi_nan.h
index 334e37a..c114a9a 100644
--- a/include/hardware_legacy/wifi_nan.h
+++ b/include/hardware_legacy/wifi_nan.h
@@ -40,6 +40,7 @@ typedef u16 transaction_id;
 typedef u32 NanDataPathId;
 
 #define NAN_MAC_ADDR_LEN                6
+#define NAN_IPV6_ADDR_LEN               16
 #define NAN_MAJOR_VERSION               2
 #define NAN_MINOR_VERSION               0
 #define NAN_MICRO_VERSION               1
@@ -2208,6 +2209,11 @@ typedef struct {
        is not associated with the NDP (out-of-band discovery).
     */
     u8 service_name[NAN_MAX_SERVICE_NAME_LEN];
+
+    /* NAN IPV6 address present or not, 0 - not present, 1 - present */
+    u8 nan_ipv6_addr_present;
+    /* NAN ipv6 address, the initiator side address */
+    u8 nan_ipv6_intf_addr[NAN_IPV6_ADDR_LEN];
 } NanDataPathInitiatorRequest;
 
 /*
@@ -2248,6 +2254,15 @@ typedef struct {
        is not associated with the NDP (out-of-band discovery).
     */
     u8 service_name[NAN_MAX_SERVICE_NAME_LEN];
+
+    /* NAN IPV6 address present or not, 0 - not present, 1 - present */
+    u8 nan_ipv6_addr_present;
+    /* NAN ipv6 address, the responder side address */
+    u8 nan_ipv6_intf_addr[NAN_IPV6_ADDR_LEN];
+    /* NAN transport port number, 0 means that port is not present */
+    u16 nan_transport_port;
+    /* NAN transport protocol, 0xFF means that protocol is not present */
+    u8 nan_transport_proto;
 } NanDataPathIndicationResponse;
 
 /* NDP termination info */
@@ -2283,6 +2298,15 @@ typedef struct {
     NanDataPathCfg ndp_cfg;
     /* App/Service information of the initiator */
     NanDataPathAppInfo app_info;
+    /*
+      If nan_peer_ndpe_support is 1 then the remote peer supports
+      NAN NDPE otherwise its set to 0.
+     */
+    u8 nan_peer_ndpe_support;
+    /* NAN IPV6 address present or not, 0 - not present, 1 - present */
+    u8 nan_ipv6_addr_present;
+    /* NAN ipv6 address, the initiator side address */
+    u8 nan_ipv6_intf_addr[NAN_IPV6_ADDR_LEN];
 } NanDataPathRequestInd;
 
 /*
@@ -2316,6 +2340,26 @@ typedef struct {
       Data indicating the Channel list and BW of the channel.
     */
     NanChannelInfo channel_info[NAN_MAX_CHANNEL_INFO_SUPPORTED];
+    /*
+      If nan_peer_ndpe_support is 1 then the remote peer supports
+      NAN NDPE otherwise its set to 0.
+    */
+    u8 nan_peer_ndpe_support;
+    /* NAN IPV6 address present or not, 0 - not present, 1 - present */
+    u8 nan_ipv6_addr_present;
+    /* NAN ipv6 address, the responder side address */
+    u8 nan_ipv6_intf_addr[NAN_IPV6_ADDR_LEN];
+    /*
+      NAN transport port number, 0 means that port is not present.
+      On the responder side the port and proto will be whatever the
+      responder has sent in the NanDataPathIndicationResponse.
+      On the initiator side the values of port and proto carry the
+      information from the remote responder peer and will be valid only
+      if remote peer supports NDPE.
+    */
+    u16 nan_transport_port;
+    /* NAN transport protocol, 0xFF meanst that protocol is not present */
+    u8 nan_transport_proto;
 } NanDataPathConfirmInd;
 
 /*
-- 
2.17.1

